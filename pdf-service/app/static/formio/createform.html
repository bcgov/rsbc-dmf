<!DOCTYPE html>
<html>
  <head>
    <link
      rel="stylesheet"
      href="/static/formio/formio.full.min.css"
    />
    <script
      src="/static/formio/formio.full.min.js"
      defer
    ></script>
    <style>
      .formio-form{page-break-inside:avoid}.formio-component{break-inside:avoid;page-break-after:auto}.formio-component-driverFunctionalityRequirements .card-header .card-title,.formio-component-driverInformation .card-header .card-title,.formio-component-finalFlags .card-header .card-title,.formio-component-formSegments .card-header .card-title,.formio-component-generalSegments .card-header .card-title,.formio-component-knownMedicalFlags .card-header .card-title,.formio-component-panel2 .card-header .card-title{font-weight:700;font-size:1.1rem;color:#000}.formio-component-driverInformation2 .card-header .card-title,.formio-component-driverInformation5 .card-header .card-title,[class*=formio-component-eDMER] .card-header .card-title{color:#fff;font-weight:700;font-size:1.1rem}.formio-component-driverFunctionalityRequirements .card-header,.formio-component-driverInformation .card-header,.formio-component-finalFlags .card-header,.formio-component-formSegments .card-header,.formio-component-generalSegments .card-header,.formio-component-knownMedicalFlags .card-header,.formio-component-panel2 .card-header{background-color:#f8f9fa;border-bottom:1px solid #ccc;padding:.75rem 1rem}.formio-component-driverInformation2 .card-header,.formio-component-driverInformation5 .card-header,[class*=formio-component-eDMER] .card-header{background-color:#36c;color:#fff;border-bottom:1px solid #ccc;padding:.75rem 1rem}.formio-component-FormSegments fieldset,.formio-component-driverFunctionalityRequirements .card,.formio-component-driverInformation .card,.formio-component-finalFlags .card,.formio-component-formSegments .card,.formio-component-generalSegments .card,.formio-component-knownMedicalFlags .card,.formio-component-panel2 .card{border:1px solid #ccc;border-radius:8px;overflow:hidden}.formio-component-driverFunctionalityRequirements .card-body,.formio-component-driverInformation .card-body,.formio-component-finalFlags .card-body,.formio-component-formSegments .card-body,.formio-component-generalSegments .card-body,.formio-component-knownMedicalFlags .card-body,.formio-component-panel2 .card-body{padding:.5rem}.formio-component-finalFlags{margin-top:1rem}.formio-component-driverInformation,.formio-component-panel2{margin-bottom:1rem}.formio-component-driverInformation .formio-component-panel .card{margin-top:.5rem;border-top:1px solid #bbb}.formio-component-driverInformation .formio-component-panel:first-of-type .card{margin-top:0;border-top:none;padding-top:0}.formio-component-driverInformation .formio-component-panel .card-header{margin-top:0;margin-bottom:0;padding-top:.5rem}.formio-component-knownMedicalFlags .formio-component-checkbox{background-color:#d4edda;border:1px solid #c3e6cb;padding:.35rem;border-radius:4px;margin-bottom:.25rem}
    </style>
    <script defer>
      document.addEventListener("DOMContentLoaded", () => {
        const formJson = JSON.parse(localStorage.getItem("formTemplate"));
        const submissionData = JSON.parse(localStorage.getItem("submissionData"));
    
        if (typeof Formio !== "undefined" && formJson) {
          Formio.createForm(document.getElementById("formio"), formJson)
            .then((form) => {
              form.submission = submissionData;
    
              // Wait until form is fully rendered (after data is set)
              form.on('change', () => {
                if (form.submission && form.submission.data) {
                  // Avoid duplicating the marker
                  if (!document.getElementById('form-render-complete')) {
                    const marker = document.createElement('div');
                    marker.id = 'form-render-complete';
                    marker.style.display = 'none';
                    document.body.appendChild(marker);
                  }
                }
              });
            })
            .catch((err) => {
              document.getElementById("formio").innerText = "Error loading form.";
            });
        } else {
          document.getElementById("formio").innerText = "Formio is undefined or no template provided.";
        }
      });
    </script> 
  </head>
  <body>
    <div id="formio">Loading form...</div>
  </body>
</html>
